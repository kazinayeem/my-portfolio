generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ---------- Enums ----------
enum PostStatus {
  DRAFT
  PUBLISHED
  ARCHIVED
}

// ---------- Admin User ----------
model Admin {
  id        String   @id @default(cuid())
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ---------- Skills ----------
model SkillCategory {
  id        String   @id @default(cuid())
  name      String   @unique
  color     String   @default("from-blue-500 to-cyan-500")
  icon      String   @default("Code")
  order     Int      @default(0)
  skills    Skill[]
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Skill {
  id         String        @id @default(cuid())
  name       String
  icon       String?
  categoryId String
  category   SkillCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  order      Int           @default(0)
  createdAt  DateTime      @default(now())
  updatedAt  DateTime      @updatedAt

  @@unique([name, categoryId])
}

// ---------- Projects ----------
model Project {
  id               String   @id @default(cuid())
  title            String
  shortDescription String
  fullDescription  String   @db.Text
  imageSrc         String
  githubLink       String
  liveLink         String?
  youtubeDemoLink  String?
  isTeamProject    Boolean  @default(false)
  isFeatured       Boolean  @default(false)
  order            Int      @default(0)
  technologies     String[] // Array of tech names
  features         String[] // Array of features
  createdAt        DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

// ---------- Education ----------
model Education {
  id          String   @id @default(cuid())
  school      String
  degree      String
  year        String
  description String   @db.Text
  gpa         String?
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// ---------- Experience ----------
model Experience {
  id          String   @id @default(cuid())
  title       String
  company     String
  year        String
  description String   @db.Text
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// ---------- Achievements ----------
model Achievement {
  id          String   @id @default(cuid())
  title       String
  description String
  order       Int      @default(0)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// ---------- Site Settings ----------
model SiteSettings {
  id          String  @id @default("main")
  heroTitle   String  @default("Hi, I'm Kazi Nayeem")
  heroSubtitle String @default("Full Stack Developer")
  heroDescription String @db.Text
  aboutTitle  String  @default("Mohammad Ali Nayeem")
  aboutDescription String @db.Text
  email       String  @default("")
  github      String  @default("")
  linkedin    String  @default("")
  resumeUrl   String  @default("")
  updatedAt   DateTime @updatedAt
}

// ---------- Models ----------
model Post {
  id          String     @id @default(cuid())
  title       String
  slug        String     @unique
  description String?
  status      PostStatus @default(DRAFT)
  publishedAt DateTime?

  content Json

  thumbnail     Bytes?
  thumbnailMime String?

  metaTitle       String?
  metaDescription String?

  author String @default("ADMIN") // Admin-only author

  categoryId Int?
  category   Category? @relation(fields: [categoryId], references: [id])

  tags PostTag[]

  readingTime Int?
  wordCount   Int?

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  @@index([status, publishedAt])
  @@index([categoryId])
}

model Category {
  id          Int     @id @default(autoincrement())
  name        String  @unique
  slug        String  @unique
  description String?

  posts Post[]
}

model Tag {
  id   Int    @id @default(autoincrement())
  name String @unique
  slug String @unique

  posts PostTag[]
}

model PostTag {
  postId String
  tagId  Int

  post Post @relation(fields: [postId], references: [id], onDelete: Cascade)
  tag  Tag  @relation(fields: [tagId], references: [id], onDelete: Cascade)

  @@id([postId, tagId])
}
